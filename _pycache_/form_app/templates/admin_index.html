<!DOCTYPE html>
<html>
<head>
  <title>Help Requests</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Base layout */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  padding: 20px;
  margin: 0;
  background-color: #f0f2f5;
  color: #333;
}

/* Page title */
h1 {
  text-align: center;
  margin-bottom: 20px;
  color: #2c3e50;
}

/* Top bar layout */
.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 20px;
  background-color: #ffffff;
  padding: 12px 20px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
}

.top-bar p {
  margin: 6px 0;
  font-weight: 600;
}

.top-bar form {
  margin-left: 10px;
}

/* Forms */
form {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 24px;
}

input, select, button {
  padding: 12px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 100%;
  box-sizing: border-box;
}

button {
  background-color: #3498db;
  color: white;
  border: none;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #2980b9;
}

tr[data-ticket-id]:hover {
  background-color: #e0f7fa;
  cursor: pointer;
}

/* Table styles */
table {
  width: 100%;
  border-collapse: collapse;
  background-color: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border-radius: 6px;
  overflow: hidden;
}

th, td {
  padding: 12px 15px;
  border-bottom: 1px solid #ddd;
  text-align: left;
}

th {
  background-color: #f7f7f7;
  font-weight: bold;
}

tr:hover {
  background-color: #f1f1f1;
}

/* Responsive form on larger screens */
@media (min-width: 600px) {
  form {
    flex-direction: row;
    flex-wrap: wrap;
    gap: 12px;
  }

  input, select {
    flex: 1;
    min-width: 140px;
  }

  button {
    width: auto;
    min-width: 100px;
  }

  .urgent {
  color: #e74c3c;
  font-weight: bold;
}

.medium {
  color: #f39c12;
}

.low {
  color: #27ae60;
}

}

  </style>
</head>
<body>

  <h1>Help Requests</h1>

  <div class="top-bar">
    <p>Logged in as: {{ user_email }}</p>
    <p>Admin status: {{is_admin}}</p>
    <form action="/logout" method="get">
      <button type="submit">Logout</button>
    </form>
    <form method="GET" action="">
        <button type="submit">Refresh</button>
    </form>
  </div>

  <form method="POST" action="/respond"> 
    <select name="timeframe" required>
      <option value="0-20 min">0-20 min</option>
      <option value="20-40 min">20-40 min</option>
      <option value="40+ min">40+ min</option>
      <option value="Completed">Completed</option>
    </select>
    <input type="number" name="ticket_id" placeholder="Ticket ID?" required>
    <input type="text" name="description" placeholder="Description">
    <button type="respond">Respond</button>
  </form>
                                                                                 
  <table>
    <tr>
      <th>Ticket ID</th>
      <th>Name</th> 
      <th>Location</th>
      <th>Urgency</th>
      <th>Description</th>
      <th>Date/Time</th>
      <th>Status</th>
    </tr>
    {% for ticket in tickets %}  <!-- FOR LOOP FOR ENTERING DATA FROM tickets INTO TABLE  -->
    <tr>
      <tr data-ticket-id="{{ ticket[0] }}">
      <td>{{ ticket[0] }}</td>
      <td>{{ ticket[1] }}</td> <!-- Currently inputs user_id not name -->
      <td>{{ ticket[2] }}</td>
      <td>{{ ticket[3] }}</td>
      <td>{{ ticket[4] }}</td>
      <td>{{ ticket[5] }}</td>
      <td>{{ ticket[6] }}</td>
    </tr>
</td>

    {% endfor %}
  </table>


  <script>
  document.querySelectorAll('tr[data-ticket-id]').forEach(row => {
    row.addEventListener('click', () => {
      const ticketId = row.getAttribute('data-ticket-id');
      const formInput = document.querySelector('input[name="ticket_id"]');
      if (formInput) {
        formInput.value = ticketId;
        formInput.focus();
        formInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });
  });
</script>
</body>
</html>